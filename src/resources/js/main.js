(()=>{"use strict";var e={973:(e,t,s)=>{s.r(t)},128:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NeoBatchActionBar=t.MatrixBatchActionBar=void 0;class s{constructor(e,t,s){this.input=e,this.blockClass=t,this.blockSelectedClass=s,this._$buttons={},this.$bar=$('<div class="block-batch-action-bar"/>').prependTo(e.$container),this._initSelect(),this.$buttons=this._generateButtons().appendTo(this.$bar),this.$menuContainer=this._generateMenu().appendTo(this.$bar);const n=this.$bar.add(this.$menu);this.supportedActions().forEach((([e,t,s])=>{const i=e.toLowerCase();this._$buttons[i]=n.find(`[data-bba-bn="button.${i}"]`),this._$buttons[i].on("activate",(e=>{e.preventDefault();const t=this[i];"function"==typeof t&&(t.bind(this)(this.getSelectedBlocks()),this._refreshButtons())}))})),this._refreshButtons()}supportedActions(){return[["Expand","expand",this.isBlockCollapsed.bind(this)],["Collapse","collapse",this.isBlockExpanded.bind(this)],["Enable","enabled",this.isBlockDisabled.bind(this)],["Disable","disabled",this.isBlockEnabled.bind(this)],["Delete","remove",e=>!0]]}isBlockCollapsed(e){return!this.isBlockExpanded(e)}isBlockDisabled(e){return!this.isBlockEnabled(e)}_initSelect(){this.$selectContainer=$("<div/>",{class:"block-batch-action-bar_select",role:"checkbox",tabindex:0,"aria-label":"Select all","aria-checked":"false"}).appendTo(this.$bar),this.$select=$('<div class="checkbox">').appendTo(this.$selectContainer);let e=!1,t=!1;const s=s=>{t||(this.input.on(this.addBlockEvent,(e=>{var t;(null!==(t=e.$block)&&void 0!==t?t:e.block.$container).toggleClass(this.input.blockSelect.settings.selectedClass,this.$select.hasClass("checked"))})),t=!0),e=!0,this.$select.toggleClass("checked").removeClass("indeterminate"),this.$select.hasClass("checked")?(this.input.blockSelect.selectAll(),this.$selectContainer.attr("aria-checked","true")):(this.input.blockSelect.deselectAll(),this.$selectContainer.attr("aria-checked","false"))};this.$selectContainer.on("mousedown",(e=>{e.which===Garnish.PRIMARY_CLICK&&s()})),this.$selectContainer.on("keydown",(e=>{e.keyCode===Garnish.SPACE_KEY&&(e.preventDefault(),s())})),this.input.blockSelect.on("selectionChange",(t=>{if(e)e=!1;else{this.$select.removeClass("checked");const e=this.input.blockSelect.$selectedItems.length>0;this.$select.toggleClass("indeterminate",e),this.$selectContainer.attr("aria-checked",e?"mixed":"false")}this._refreshButtons()}))}_refreshButtons(){const e={},t=[];this.supportedActions().forEach((([s,n,i])=>{t.push(s),e[s]={icon:n,check:i,enable:!1}})),this.input.blockSelect.$selectedItems.each(((s,n)=>{const i=$(n);t.forEach((t=>{var s;(s=e[t]).enable||(s.enable=e[t].check(i))}))})),t.forEach((t=>{this._$buttons[t.toLowerCase()].toggleClass("disabled",!1===e[t].enable)}))}_generateButtons(){const e=$('<div class="btngroup"/>');return this.supportedActions().forEach((([t,s,n])=>this._generateAction(t,s,"btn").appendTo(e))),e}_generateMenu(){var e;const t=$('<div class="block-batch-action-bar_menu hidden"/>'),s=$('<button type="button" class="btn settings icon menubtn">Actions</button>').appendTo(t);this.$menu=$('<div class="menu"/>').appendTo(t);const n=$('<ul class="padded"/>').appendTo(this.$menu);this.supportedActions().forEach((([e,t])=>$("<li/>").append(this._generateAction(e,t)).appendTo(n))),s.menubtn();let i=null!==(e=this.$buttons.width())&&void 0!==e?e:0;return this.$bar.on("resize",(()=>{var e,s;i||(i=null!==(e=this.$buttons.width())&&void 0!==e?e:0);const n=(null!==(s=this.$bar.width())&&void 0!==s?s:0)<i;this.$buttons.toggleClass("hidden",n),t.toggleClass("hidden",!n)})),t}_generateAction(e,t,s){const n=void 0!==s,i=e.toLowerCase();null!=t||(t=i);const a=$(`<${n?"button":"a"}/>`).attr({"aria-label":e,"data-bba-bn":`button.${i}`,"data-icon":t}).text(e);return n&&a.addClass(s),a}expand(e){e.forEach((e=>e.expand()))}collapse(e){e.forEach((e=>e.collapse()))}}t.MatrixBatchActionBar=class extends s{constructor(e){super(e,"matrixblock","sel"),this.input=e,super.addBlockEvent="blockAdded"}isBlockExpanded(e){return!e.hasClass("collapsed")}isBlockEnabled(e){return!e.hasClass("disabled")}getSelectedBlocks(){return this.input.$container.find(`.${this.blockClass}.${this.blockSelectedClass}`).map(((e,t)=>$(t).data("block"))).get()}enable(e){e.forEach((e=>e.enable()))}disable(e){e.forEach((e=>e.disable()))}delete(e){window.confirm("Are you sure you want to delete the selected blocks?")&&e.forEach((e=>e.selfDestruct()))}},t.NeoBatchActionBar=class extends s{constructor(e){super(e,"ni_block","is-selected"),this.input=e,super.addBlockEvent="addBlock"}isBlockExpanded(e){return e.hasClass("is-expanded")}isBlockEnabled(e){return e.hasClass("is-enabled")}getSelectedBlocks(){return this.input.getBlocks().filter((e=>e.isSelected()))}enable(e){var t;null===(t=e.find((e=>!e.isEnabled())))||void 0===t||t.enable()}disable(e){var t;null===(t=e.find((e=>e.isEnabled())))||void 0===t||t.disable()}delete(e){window.confirm("Are you sure you want to delete the selected blocks?")&&e.forEach((e=>this.input.removeBlock(e)))}}}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,s),a.exports}s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=s(128);s(973);const t=[];Garnish.on(Craft.MatrixInput,"afterInit",(s=>{t.push(new e.MatrixBatchActionBar(s.target))})),void 0!==(null===Neo||void 0===Neo?void 0:Neo.Input)&&Garnish.on(Neo.Input,"afterInit",(s=>{void 0!==s.target.blockSelect&&t.push(new e.NeoBatchActionBar(s.target))}))})()})();
//# sourceMappingURL=main.js.map